### **obj_unit_squirrel (다람쥐 유닛) 상세 정보**

다람쥐는 맵에 떨어진 '도토리'를 줍고 사용하며 강력한 특수 능력을 발휘하는 기동성 높은 유닛입니다. 주운 도토리의 수에 따라 공격력이 결정되어 유닛의 성능이 크게 달라집니다.

*   **역할**: 성장형 공격수 (Nuker) / 전략적 핵심 유닛
*   **기본 능력치**:
    *   **체력**: 150
    *   **기본 공격력**: 150
*   **핵심 자원**: **도토리**
    *   **공격력 계산**: `기본 공격력(150) + 보유한 도토리 수`
    *   최대 공격력은 **1300**까지 도달할 수 있습니다.
    *   맵에 있는 도토리를 줍거나, 특정 위치에 버릴 수 있습니다.

*   **이동**:
    *   체스의 '퀸(Queen)'처럼 **상하좌우 및 대각선 방향으로 제약 없이** 움직일 수 있습니다.
    *   **도토리 타일로의 특수 이동 (Shift)**:
        *   주변 3칸 이내에 도토리(`queen_modifier` 값을 가진)가 있는 빈 타일이 있을 경우, 해당 타일로 **즉시 이동**할 수 있습니다.
        *   이동 후 도토리를 줍거나 버리는 행동을 했을 경우, **그 자리에서 즉시 추가 행동 기회**를 얻어 연쇄적인 이동 및 행동이 가능합니다.

*   **공격**:
    *   현재 공격력(기본 공격력 + 도토리 수)만큼의 피해를 줍니다.
    *   공격 후에는 일반적으로 보유했던 도토리를 모두 소모하며(공격력은 150으로 초기화), 소모된 도토리는 **공격받은 대상의 위치에서 퍼져나가** 주변 타일에 떨어집니다.

*   **특수 능력 (현재 공격력에 따른 보너스)**:
    *   **공격력이 10의 배수일 때**: 턴을 종료해도 보유한 도토리가 **사라지지 않습니다.** (공격력이 유지됩니다)
    *   **공격력이 100의 배수일 때**: 공격 시 **도토리를 소모하지 않습니다.** (공격력이 유지됩니다)
    *   **공격력이 1000의 배수일 때**: 공격 시 **도토리를 소모하지 않으며, 상대를 즉사**시킵니다.

*   **패널티**:
    *   **턴 종료 시**: 현재 공격력이 10의 배수가 아닐 경우, 가지고 있던 모든 도토리를 현재 위치에 떨어트리고 공격력이 150으로 초기화됩니다. 이때 도토리는 **다람쥐가 있던 자리에서 퍼져나가** 주변 타일에 떨어집니다.
    *   **사망 시**: 보유하고 있던 모든 도토리를 그 자리에 떨어트립니다. 이때 도토리는 **다람쥐가 사망한 자리에서 퍼져나가** 주변 타일에 떨어집니다.

---

### [부록] 도토리(Acorn) 드롭 알고리즘 (`drop_queen_modifier`)

다람쥐가 드롭하는 도토리는 `drop_queen_modifier` 함수에 의해 맵에 배치됩니다. 이 함수의 핵심 목표는 정해진 총량의 도토리를 여러 타일에 걸쳐 분배하는 것이며, 동작 방식은 시각 효과의 시작점 유무에 따라 두 가지로 나뉩니다.

#### 1. 특정 위치 기반 드롭 (예: 공격 시, 턴 종료 시)

시작 위치가 지정된 경우, 도토리는 정교한 가중치 분배 알고리즘을 따릅니다.

1.  **맵 분할**: 전체 맵을 가로 중앙을 기준으로 `왼쪽`, `중앙`, `오른쪽` 세 구역으로 나눕니다.

2.  **중앙 특별 분배 (시작점이 중앙 부근일 경우)**:
    *   만약 드롭 시작점이 맵의 중앙 지역이라면, 시스템은 **'중앙 특별 보너스'**를 먼저 계산합니다.
    *   전체 도토리의 약 **6% ~ 14%** 에 해당하는 양을 **10의 배수**로 맞춰서(예: 30, 50, 110), 중앙 구역의 타일 한 곳에 먼저 배치합니다.
    *   이는 중앙 지역에서의 드롭에 특별한 가치를 부여하는 예외 처리 로직입니다.

3.  **좌/우 비대칭 분배**:
    *   '(중앙 특별 분배 후) 남은 도토리'를 `왼쪽`과 `오른쪽` 구역에 나누어 분배합니다.
    *   분배 비율은 무작위적이지만, **한쪽에 약 30%~70%**, **다른 쪽에 나머지 70%~30%** 가 할당되는 방식입니다. 이 비율은 드롭 시작 위치와는 무관하게 무작위로 결정되어, 어느 한쪽이 항상 더 많이 받는 구조는 아닙니다.

4.  **최종 분배**:
    *   각 구역(좌, 우)에 할당된 총량 내에서, 지정된 개수의 타일에 무작위 양의 도토리가 나뉘어 배치됩니다.

이 방식은 도토리 드롭이 완전한 무작위가 아닌, 특정 위치를 중심으로 방향성을 가지면서도 예측 불가능성을 유지하게 하여 전략적 깊이를 더합니다.

#### 2. 일반 드롭 (위치 미지정)

별도의 시작 위치가 지정되지 않은 경우, 알고리즘은 훨씬 단순하게 동작합니다.

1.  맵 전체에서 도토리가 없는 모든 빈 타일을 수집합니다.
2.  수집된 타일 목록을 무작위로 섞습니다.
3.  섞인 타일 목록에서 정해진 개수만큼의 타일을 골라 무작위 양의 도토리를 분배합니다.